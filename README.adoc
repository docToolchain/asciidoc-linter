= AsciiDoc Linter
:icons: font
:source-highlighter: rouge
:experimental:

image:https://img.shields.io/badge/license-MIT-blue.svg[License: MIT,link=https://opensource.org/licenses/MIT]
image:https://img.shields.io/badge/python-3.8+-blue.svg[Python Version]
image:https://img.shields.io/badge/test--coverage-95%25-green.svg[Test Coverage]
image:https://img.shields.io/badge/tests-97%25-green.svg[Test Success Rate]

A Python-based linter for AsciiDoc files that helps maintain consistent documentation quality and style.
Part of the docToolchain project.

== About

AsciiDoc Linter is a command-line tool that checks your AsciiDoc files for common issues and style violations.
It helps maintain consistent documentation by enforcing rules for heading structure, formatting, whitespace, and image usage.

[NOTE]
====
This project is part of docToolchain (https://doctoolchain.org), a collection of documentation tools and best practices.
====

== Features

=== Implemented Rules

[cols="1,2,1,1"]
|===
|Rule ID |Description |Severity |Status

|HEAD001
|Check for proper heading hierarchy (no skipping levels)
|ERROR
|âœ… Stable

|HEAD002
|Verify heading format (spacing and capitalization)
|ERROR/WARNING
|âœ… Stable

|HEAD003
|Detect multiple top-level headers
|ERROR
|âœ… Stable

|BLOCK001
|Check for unterminated blocks (listing, example, sidebar, etc.)
|ERROR
|âœ… Stable

|BLOCK002
|Verify proper spacing around blocks
|WARNING
|âœ… Stable

|WS001
|Check whitespace usage (blank lines, list markers, tabs)
|WARNING
|âœ… Stable

|IMG001
|Verify image attributes and file references
|WARNING/ERROR
|âœ… Stable

|TABLE001
|Table formatting consistency
|WARNING/ERROR
|âš ï¸ Beta

|FMT001
|Detect explicit numbered lists (1., 2., etc.) instead of AsciiDoc dot-syntax
|WARNING
|âœ… Stable

|FMT002
|Detect non-semantic definition list patterns (*Term*: instead of Term::)
|WARNING
|âœ… Stable

|FMT003
|Detect counter syntax in section titles ({counter:...})
|WARNING
|âœ… Stable

|FMT004
|Detect Markdown syntax in AsciiDoc files (headings, links, images, code blocks)
|WARNING
|âœ… Stable

|FMT005
|Detect Markdown table syntax (pipe-separated tables with separator lines)
|ERROR
|âœ… Stable
|===

=== Planned Rules

* TABLE002: Table content validation
* LINK001: Broken internal references

== Installation

[source,bash]
----
# Clone the repository
git clone https://github.com/docToolchain/asciidoc-linter.git

# Navigate to the project directory
cd asciidoc-linter

# Install the package
pip install .
----

== Usage

=== Basic Usage

[source,bash]
----
# Check a single file
asciidoc-linter document.adoc

# Check multiple files
asciidoc-linter doc1.adoc doc2.adoc

# Check with specific output format
asciidoc-linter --format json document.adoc
----

=== Output Formats

The linter supports three output formats:

* `console` (default): Human-readable output with color
* `plain`: Human-readable output without color
* `json`: Machine-readable JSON format
* `html`: HTML report format

=== Example Output

[source]
----
Checking file: document.adoc

ERROR: Heading level skipped: found h3 after h1 (line 15)
  === Advanced Topics

WARNING: Heading should start with uppercase letter (line 23)
  == introduction to concepts

ERROR: Unterminated listing block starting (line 45)
  ----

WARNING: Block should be preceded by a blank line (line 67)
  ----

ERROR: Multiple top-level headings found (line 30)
  First heading at line 1: 'Document Title'

WARNING: Missing alt text for image: diagram.png (line 80)
  image::diagram.png[]
----

== Using with Docker

You can run the AsciiDoc Linter in a Docker container without installing Python locally.

=== Build the Docker image

[source,bash]
----
docker build -t asciidoc-linter .
----

=== Run the linter

[source,bash]
----
docker run --rm -v $(pwd):/docs asciidoc-linter document.adoc
----

Replace `document.adoc` with the path to the AsciiDoc file you want to lint.
The `-v $(pwd):/docs` option mounts the current directory to `/docs` inside the container.

== Using as a GitHub Action

You can automatically lint your AsciiDoc files on every push or pull request by adding a workflow file.

Create `.github/workflows/asciidoc-linter.yml`:

[source,yaml]
----
name: AsciiDoc Linter

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Build Docker image
        run: docker build -t asciidoc-linter .

      - name: Run AsciiDoc Linter
        run: |
          for file in $(find . -name "*.adoc" -type f); do
            docker run --rm -v ${{ github.workspace }}:/docs asciidoc-linter "$file"
          done
----

== Using with pre-commit

You can integrate AsciiDoc Linter into your https://pre-commit.com[pre-commit] workflow to automatically check AsciiDoc files before committing.

=== Installation

Add the following to your `.pre-commit-config.yaml`:

[source,yaml]
----
repos:
  - repo: https://github.com/docToolchain/asciidoc-linter
    rev: v0.2.0  # Use the latest release tag
    hooks:
      - id: asciidoc-linter
----

=== Usage

[source,bash]
----
# Install pre-commit hooks
pre-commit install

# Run manually on all files
pre-commit run --all-files

# Run automatically on git commit
git commit -m "Your commit message"
----

The hook will automatically check all `.adoc` and `.asciidoc` files in your repository before each commit.

== Development

=== Current Status

* Test Coverage: 95%
* Test Success Rate: 100% (248/248 tests passing)
* Known Issues:
** Table content validation needs improvement

=== Running Tests

[source,bash]
----
# Run all tests
python -m pytest

# Run specific test file
python -m pytest tests/rules/test_heading_rules.py

# Run tests with coverage
python run_tests_html.py
----

=== Project Structure

[source]
----
asciidoc-linter/
â”œâ”€â”€ asciidoc_linter/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ cli.py
â”‚   â”œâ”€â”€ linter.py
â”‚   â”œâ”€â”€ parser.py
â”‚   â”œâ”€â”€ reporter.py
â”‚   â””â”€â”€ rules/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ base.py
â”‚       â”œâ”€â”€ base_rules.py
â”‚       â”œâ”€â”€ block_rules.py
â”‚       â”œâ”€â”€ format_rules.py
â”‚       â”œâ”€â”€ heading_rules.py
â”‚       â”œâ”€â”€ image_rules.py
â”‚       â”œâ”€â”€ table_rules.py
â”‚       â””â”€â”€ whitespace_rules.py
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ test_base.py
â”‚   â”œâ”€â”€ test_cli.py
â”‚   â”œâ”€â”€ test_linter.py
â”‚   â”œâ”€â”€ test_reporter.py
â”‚   â””â”€â”€ rules/
â”‚       â”œâ”€â”€ test_block_rules.py
â”‚       â”œâ”€â”€ test_format_rules.py
â”‚       â”œâ”€â”€ test_heading_rules.py
â”‚       â”œâ”€â”€ test_image_rules.py
â”‚       â”œâ”€â”€ test_table_rules.py
â”‚       â””â”€â”€ test_whitespace_rules.py
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ arc42/
â”‚   â”œâ”€â”€ manual/
â”‚   â”œâ”€â”€ test-results/
â”‚   â”œâ”€â”€ requirements.adoc
â”‚   â””â”€â”€ implementation_plan.adoc
â”œâ”€â”€ README.adoc
â””â”€â”€ run_tests.py
----

== Contributing

Contributions are welcome!
Please feel free to submit a Pull Request.
For major changes, please open an issue first to discuss what you would like to change.

=== Development Guidelines

. Write tests for new rules
. Update documentation
. Follow Python code style guidelines
. Add appropriate error messages and context
. Ensure test coverage remains above 90%

== License

This project is licensed under the MIT License - see the LICENSE file for details.

== Acknowledgments

* Part of the docToolchain project (https://doctoolchain.org)
* Inspired by various linting tools and the need for better AsciiDoc quality control
* Thanks to the AsciiDoc community for their excellent documentation and tools

== Roadmap

=== Phase 1 (Current)

* âœ… Basic heading rules
* âœ… Block structure rules
* âœ… Whitespace rules
* âœ… Image validation
* âš ï¸ Table validation
* â³ Configuration system

=== Phase 2 (Next)

* ğŸ”² Fix table content validation
* ğŸ”² Improve test coverage
* ğŸ”² Add link checking
* âœ… Add format rules (FMT001-FMT004)

=== Phase 3 (Future)

* ğŸ”² IDE integration
* âœ… Git pre-commit hooks
* ğŸ”² Custom rule development
* ğŸ”² Performance optimization

== Contact

* Project Homepage: https://github.com/docToolchain/asciidoc-linter
* Issue Tracker: https://github.com/docToolchain/asciidoc-linter/issues
* docToolchain Homepage: https://doctoolchain.org