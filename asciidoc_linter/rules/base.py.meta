Updated base.py with check_line implementation