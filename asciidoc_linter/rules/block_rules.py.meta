Updated implementation of block rules